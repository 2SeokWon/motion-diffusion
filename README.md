# Motion Transformer

μΈκ°„ λ™μ‘ μƒμ„±μ„ μ„ν• νΈλμ¤ν¬λ¨Έ κΈ°λ° λ””ν“¨μ „ λ¨λΈμ…λ‹λ‹¤. μ΄ ν”„λ΅μ νΈλ” BVH νμΌμ„ μ‚¬μ©ν•μ—¬ μΈκ°„μ λ™μ‘ λ°μ΄ν„°λ¥Ό ν•™μµν•κ³ , μƒλ΅μ΄ λ™μ‘μ„ μƒμ„±ν•  μ μμµλ‹λ‹¤.

## π€ λΉ λ¥Έ μ‹μ‘

### 1. ν™κ²½ μ„¤μ •

λ¨Όμ € condaλ¥Ό μ‚¬μ©ν•μ—¬ κ°€μƒν™κ²½μ„ μƒμ„±ν•©λ‹λ‹¤:

```bash
# κ°€μƒν™κ²½ μƒμ„± λ° ν™μ„±ν™”
conda env create -f environment.yml
conda activate pyopengl
```

### 2. λ°μ΄ν„° μ „μ²λ¦¬

BVH νμΌλ“¤μ„ λ¨λΈ ν•™μµμ— μ ν•©ν• ν•νƒλ΅ μ „μ²λ¦¬ν•©λ‹λ‹¤:

```bash
python preprocess_bvh.py
```

μ΄ λ‹¨κ³„μ—μ„λ”:
- `dataset/` ν΄λ”μ BVH νμΌλ“¤μ„ μ½μ–΄μµλ‹λ‹¤
- κ΄€μ  νμ „μ„ 6D ν‘ν„μΌλ΅ λ³€ν™ν•©λ‹λ‹¤
- λ£¨νΈ λ¨μ… νΉμ§•μ„ μ¶”μ¶ν•©λ‹λ‹¤
- μ „μ²λ¦¬λ λ°μ΄ν„°λ¥Ό `processed_data/` ν΄λ”μ— μ €μ¥ν•©λ‹λ‹¤

### 3. λ¨λΈ ν•™μµ

μ „μ²λ¦¬λ λ°μ΄ν„°λ¥Ό μ‚¬μ©ν•μ—¬ λ¨λΈμ„ ν•™μµν•©λ‹λ‹¤:

```bash
python train.py
```

ν•™μµ κ³Όμ •μ—μ„:
- λ¨λΈ μ²΄ν¬ν¬μΈνΈκ°€ `checkpoints/` ν΄λ”μ— μ €μ¥λ©λ‹λ‹¤
- κΈ°λ³Έμ μΌλ΅ 10 μ—ν¬ν¬λ§λ‹¤ μ²΄ν¬ν¬μΈνΈκ°€ μ €μ¥λ©λ‹λ‹¤
- μ΄ 500 μ—ν¬ν¬ λ™μ• ν•™μµμ΄ μ§„ν–‰λ©λ‹λ‹¤

### 4. λ™μ‘ μƒμ„±

ν•™μµλ λ¨λΈμ„ μ‚¬μ©ν•μ—¬ μƒλ΅μ΄ λ™μ‘μ„ μƒμ„±ν•©λ‹λ‹¤:

```bash
python generate.py --checkpoint_path checkpoints/model_epoch_250.pt
```

#### μƒμ„± μµμ…

`generate.py`λ” λ‹¤μκ³Ό κ°™μ€ μΈμλ¥Ό λ°›μµλ‹λ‹¤:

- `--checkpoint_path` (ν•„μ): μ‚¬μ©ν•  λ¨λΈ μ²΄ν¬ν¬μΈνΈ νμΌμ κ²½λ΅
  ```bash
  --checkpoint_path checkpoints/model_epoch_250.pt
  ```

- `--num_samples` (μ„ νƒ, κΈ°λ³Έκ°’: 5): μƒμ„±ν•  λ™μ‘ μƒν”μ κ°μ
  ```bash
  --num_samples 10
  ```

- `--seq_len` (μ„ νƒ, κΈ°λ³Έκ°’: 180): μƒμ„±ν•  λ™μ‘ μ‹ν€€μ¤μ κΈΈμ΄ (ν”„λ μ„ λ‹¨μ„)
  ```bash
  --seq_len 240
  ```

#### μμ‹ μ‚¬μ©λ²•

```bash
# κΈ°λ³Έ μ„¤μ •μΌλ΅ 5κ° μƒν” μƒμ„± (180 ν”„λ μ„)
python generate.py --checkpoint_path checkpoints/model_epoch_250.pt

# 10κ° μƒν”μ„ 240 ν”„λ μ„ κΈΈμ΄λ΅ μƒμ„±
python generate.py --checkpoint_path checkpoints/model_epoch_250.pt --num_samples 10 --seq_len 240

# μµμ‹  μ²΄ν¬ν¬μΈνΈ μ‚¬μ©
python generate.py --checkpoint_path checkpoints/model_epoch_500.pt --num_samples 3 --seq_len 120
```

μƒμ„±λ BVH νμΌλ“¤μ€ `results/` ν΄λ”μ— μ €μ¥λ©λ‹λ‹¤.

## οΏ½ ν”„λ΅μ νΈ κµ¬μ΅°

```
motion_transformer/
β”β”€β”€ dataset/                    # μ›λ³Έ BVH νμΌλ“¤
β”β”€β”€ processed_data/            # μ „μ²λ¦¬λ λ°μ΄ν„°
β”β”€β”€ checkpoints/              # ν•™μµλ λ¨λΈ μ²΄ν¬ν¬μΈνΈ
β”β”€β”€ results/                  # μƒμ„±λ BVH νμΌλ“¤
β”β”€β”€ bvh_viewer/              # BVH νμΌ μ‹κ°ν™” λ„κµ¬
β”β”€β”€ environment.yml          # Conda ν™κ²½ μ„¤μ •
β”β”€β”€ preprocess_bvh.py       # λ°μ΄ν„° μ „μ²λ¦¬ μ¤ν¬λ¦½νΈ
β”β”€β”€ train.py                # λ¨λΈ ν•™μµ μ¤ν¬λ¦½νΈ
β”β”€β”€ generate.py             # λ™μ‘ μƒμ„± μ¤ν¬λ¦½νΈ
β”β”€β”€ model.py                # νΈλμ¤ν¬λ¨Έ λ¨λΈ μ •μ
β”β”€β”€ gaussian_diffusion.py   # λ””ν“¨μ „ λ¨λΈ κµ¬ν„
β”β”€β”€ dataset.py              # λ°μ΄ν„°μ…‹ ν΄λμ¤
β”β”€β”€ kinematics.py           # μ΄λ™ν•™ μ ν‹Έλ¦¬ν‹°
β””β”€β”€ utils.py                # κΈ°νƒ€ μ ν‹Έλ¦¬ν‹° ν•¨μ
```

## οΏ½οΏ½π”§ λ¨λΈ μ„¤μ •

- **κ΄€μ  μ**: 23κ°
- **μ…λ ¥ νΉμ§•**: λ£¨νΈ λ¨μ…(4μ°¨μ›) + κ΄€μ  νμ „(23 Γ— 6μ°¨μ›)
- **μ‹ν€€μ¤ κΈΈμ΄**: κΈ°λ³Έ 180 ν”„λ μ„ (μ΅°μ • κ°€λ¥)
- **λ””ν“¨μ „ νƒ€μ„μ¤ν…**: 1000λ‹¨κ³„

## π“ λ°μ΄ν„°μ…‹

ν”„λ΅μ νΈλ” λ‹¤μκ³Ό κ°™μ€ λ™μ‘ μΉ΄ν…κ³ λ¦¬μ BVH νμΌμ„ ν¬ν•¨ν•©λ‹λ‹¤:
- Aeroplane (λΉ„ν–‰κΈ° λ™μ‘)
- Angry (ν™”λ‚ λ™μ‘)
- Chicken (μΉν‚¨ λ„μ¤)
- Drunk (μ·¨ν• λ™μ‘)
- InTheDark (μ–΄λ‘  μ† λ™μ‘)
- KarateChop (κ°€λΌν… λ™μ‘)

κ° μΉ΄ν…κ³ λ¦¬λ” λ‹¤μ–‘ν• λ°©ν–¥κ³Ό μ¤νƒ€μΌ λ³€ν•μ„ ν¬ν•¨ν•©λ‹λ‹¤.

## π― BVH νμΌ μ‹κ°ν™”

μƒμ„±λ BVH νμΌμ„ ν™•μΈν•λ ¤λ©΄ `bvh_viewer/` ν΄λ”μ μ‹κ°ν™” λ„κµ¬λ¥Ό μ‚¬μ©ν•  μ μμµλ‹λ‹¤:

```bash
cd bvh_viewer
python main.py [BVH_FILE_PATH]
```

μμ‹:
```bash
cd bvh_viewer
python main.py ../results/generated_sample_001.bvh
python main.py ../dataset/Aeroplane_BR.bvh
```

## β οΈ μ£Όμμ‚¬ν•­

- CUDA μ§€μ› GPUκ°€ μμΌλ©΄ μλ™μΌλ΅ GPUλ¥Ό μ‚¬μ©ν•©λ‹λ‹¤
- ν•™μµμ€ μƒλ‹Ήν• μ‹κ°„μ΄ μ†μ”λ  μ μμµλ‹λ‹¤ (GPU κ¶μ¥)
- μ¶©λ¶„ν• λ””μ¤ν¬ κ³µκ°„μ΄ ν•„μ”ν•©λ‹λ‹¤ (μ²΄ν¬ν¬μΈνΈ λ° κ²°κ³Ό νμΌ)

## π“„ λΌμ΄μ„Όμ¤

μ΄ ν”„λ΅μ νΈλ” μ—°κµ¬ λ° κµμ΅ λ©μ μΌλ΅ μ‚¬μ©ν•  μ μμµλ‹λ‹¤.
